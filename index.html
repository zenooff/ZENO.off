<script>
    // ‚≠ê √âTOILES
    const starsContainer = document.getElementById("stars");
    for (let i = 0; i < 150; i++) {
        const star = document.createElement("div");
        star.className = "star";
        star.style.top = Math.random() * 100 + "%";
        star.style.left = Math.random() * 100 + "%";
        star.style.animationDelay = Math.random() * 3 + "s";
        starsContainer.appendChild(star);
    }

    // üîê HASH SHA-256
    async function hashPassword(password) {
        const encoder = new TextEncoder();
        const data = encoder.encode(password);
        const hashBuffer = await crypto.subtle.digest("SHA-256", data);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        return hashArray.map(b => b.toString(16).padStart(2, "0")).join("");
    }

    function showRegister() {
        document.getElementById("main-buttons").style.display = "none";
        document.getElementById("register-form").style.display = "block";
    }

    function showLogin() {
        document.getElementById("main-buttons").style.display = "none";
        document.getElementById("login-form").style.display = "block";
    }

    function back() {
        document.getElementById("register-form").style.display = "none";
        document.getElementById("login-form").style.display = "none";
        document.getElementById("main-buttons").style.display = "block";
    }

    // üìù INSCRIPTION
    async function register() {
        const username = document.getElementById("reg-username").value;
        const email = document.getElementById("reg-email").value;
        const password = document.getElementById("reg-password").value;

        if (!username || !email || !password) {
            alert("Veuillez remplir tous les champs");
            return;
        }

        const hashedPassword = await hashPassword(password);

        localStorage.setItem("zenoUser", JSON.stringify({
            username,
            email,
            password: hashedPassword
        }));

        alert("Compte cr√©√© avec mot de passe s√©curis√© üîê");
        back();
    }

    // üîì CONNEXION
    async function login() {
        const email = document.getElementById("login-email").value;
        const password = document.getElementById("login-password").value;

        const user = JSON.parse(localStorage.getItem("zenoUser"));
        if (!user) {
            alert("Aucun compte trouv√©");
            return;
        }

        const hashedPassword = await hashPassword(password);

        if (user.email !== email || user.password !== hashedPassword) {
            alert("Identifiants incorrects");
            return;
        }

        alert("Connexion r√©ussie üî• Bienvenue " + user.username);
    }
</script>
